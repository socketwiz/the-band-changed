define(["jquery"],function(t){!function(t){function e(t,e,n){var o=t.children(),i=!1;t.empty();for(var d=0,a=o.length;a>d;d++){var l=o.eq(d);if(t.append(l),n&&t.append(n),r(t,e)){l.remove(),i=!0;break}n&&n.remove()}return i}function n(e,i,d,a,l){var u=e.contents(),c=!1;e.empty();for(var s="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style",f=0,h=u.length;h>f&&!c;f++){var p=u[f],v=t(p);void 0!==p&&(e.append(v),l&&e[e.is(s)?"after":"append"](l),3==p.nodeType?r(d,a)&&(c=o(v,i,d,a,l)):c=n(v,i,d,a,l),c||l&&l.remove())}return c}function o(t,e,n,d,u){var c=!1,s=t[0];if(void 0===s)return!1;for(var f="letter"==d.wrap?"":" ",h=l(s).split(f),p=-1,v=-1,g=0,w=h.length-1;w>=g;){var m=Math.floor((g+w)/2);if(m==v)break;v=m,a(s,h.slice(0,v+1).join(f)+d.ellipsis),r(n,d)?w=v:(p=v,g=v)}if(-1==p||1==h.length&&0==h[0].length){var b=t.parent();t.remove();var y=u?u.length:0;if(b.contents().size()>y){var x=b.contents().eq(-1-y);c=o(x,e,n,d,u)}else{var T=b.prev(),s=T.contents().eq(-1)[0];if(void 0!==s){var C=i(l(s),d);a(s,C),u&&T.append(u),b.remove(),c=!0}}}else{var C=i(h.slice(0,p+1).join(f),d);c=!0,a(s,C)}return c}function r(t,e){return t.innerHeight()>e.maxHeight}function i(e,n){for(;t.inArray(e.slice(-1),n.lastCharacter.remove)>-1;)e=e.slice(0,-1);return 0>t.inArray(e.slice(-1),n.lastCharacter.noEllipsis)&&(e+=n.ellipsis),e}function d(t){return{width:t.innerWidth(),height:t.innerHeight()}}function a(t,e){t.innerText?t.innerText=e:t.nodeValue?t.nodeValue=e:t.textContent&&(t.textContent=e)}function l(t){return t.innerText?t.innerText:t.nodeValue?t.nodeValue:t.textContent?t.textContent:""}function u(e,n){return void 0===e?!1:e?"string"==typeof e?(e=t(e,n),e.length?e:!1):"object"==typeof e?void 0===e.jquery?!1:e:!1:!1}function c(t){for(var e=t.innerHeight(),n=["paddingTop","paddingBottom"],o=0,r=n.length;r>o;o++){var i=parseInt(t.css(n[o]),10);isNaN(i)&&(i=0),e-=i}return e}function s(t,e){return t?(e="string"==typeof e?"dotdotdot: "+e:["dotdotdot:",e],void 0!==window.console&&void 0!==window.console.log&&window.console.log(e),!1):!1}if(!t.fn.dotdotdot){t.fn.dotdotdot=function(o){if(0==this.length)return o&&o.debug===!1||s(!0,'No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){t(this).dotdotdot(o)});var i=this;i.data("dotdotdot")&&i.trigger("destroy.dot"),i.data("dotdotdot-style",i.attr("style")),i.css("word-wrap","break-word"),i.bind_events=function(){return i.bind("update.dot",function(o,d){o.preventDefault(),o.stopPropagation(),l.maxHeight="number"==typeof l.height?l.height:c(i),l.maxHeight+=l.tolerance,void 0!==d&&(("string"==typeof d||d instanceof HTMLElement)&&(d=t("<div />").append(d).contents()),d instanceof t&&(a=d)),g=i.wrapInner('<div class="dotdotdot" />').children(),g.empty().append(a.clone(!0)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var u=!1,s=!1;return h.afterElement&&(u=h.afterElement.clone(!0),h.afterElement.remove()),r(g,l)&&(s="children"==l.wrap?e(g,l,u):n(g,i,g,l,u)),g.replaceWith(g.contents()),g=null,t.isFunction(l.callback)&&l.callback.call(i[0],s,a),h.isTruncated=s,s}).bind("isTruncated.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(i[0],h.isTruncated),h.isTruncated}).bind("originalContent.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(i[0],a),a}).bind("destroy.dot",function(t){t.preventDefault(),t.stopPropagation(),i.unwatch().unbind_events().empty().append(a).attr("style",i.data("dotdotdot-style")).data("dotdotdot",!1)}),i},i.unbind_events=function(){return i.unbind(".dot"),i},i.watch=function(){if(i.unwatch(),"window"==l.watch){var e=t(window),n=e.width(),o=e.height();e.bind("resize.dot"+h.dotId,function(){n==e.width()&&o==e.height()&&l.windowResizeFix||(n=e.width(),o=e.height(),v&&clearInterval(v),v=setTimeout(function(){i.trigger("update.dot")},10))})}else p=d(i),v=setInterval(function(){var t=d(i);(p.width!=t.width||p.height!=t.height)&&(i.trigger("update.dot"),p=d(i))},100);return i},i.unwatch=function(){return t(window).unbind("resize.dot"+h.dotId),v&&clearInterval(v),i};var a=i.contents(),l=t.extend(!0,{},t.fn.dotdotdot.defaults,o),h={},p={},v=null,g=null;return h.afterElement=u(l.after,i),h.isTruncated=!1,h.dotId=f++,i.data("dotdotdot",!0).bind_events().trigger("update.dot"),l.watch&&i.watch(),i},t.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0,debug:!1};var f=1,h=t.fn.html;t.fn.html=function(t){return void 0!==t?this.data("dotdotdot")&&"function"!=typeof t?this.trigger("update",[t]):h.call(this,t):h.call(this)};var p=t.fn.text;t.fn.text=function(e){if(void 0!==e){if(this.data("dotdotdot")){var n=t("<div />");return n.text(e),e=n.html(),n.remove(),this.trigger("update",[e])}return p.call(this,e)}return p.call(this)}}}(t)});
//# sourceMappingURL=jquery.dotdotdot.js.map